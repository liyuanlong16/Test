Sub ProcessPostalCodes()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(1)

    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    Dim postalDict As Object
    Set postalDict = CreateObject("Scripting.Dictionary")

    Dim deleteCount As Long
    deleteCount = 0

    ' Collect rows by postal code
    For i = 2 To lastRow
        Dim postalCode As String
        postalCode = ws.Cells(i, 1).Value

        If postalDict.exists(postalCode) Then
            postalDict(postalCode).Add i
        Else
            postalDict.Add postalCode, New Collection
            postalDict(postalCode).Add i
        End If
    Next i

    ' Process each group of rows with the same postal code
    Dim key As Variant
    For Each key In postalDict.Keys
        Dim rows As Collection
        Set rows = postalDict(key)

        If rows.Count > 1 Then
            Dim retainRow As Long
            retainRow = rows(1)

            Dim firstC As String, firstD As String, firstF As String, firstG As String
            firstC = ws.Cells(retainRow, 3).Value
            firstD = ws.Cells(retainRow, 4).Value
            firstF = ws.Cells(retainRow, 6).Value
            firstG = ws.Cells(retainRow, 7).Value

            Dim clearContents As Boolean
            Dim rowToDelete As Long
            For i = rows.Count To 2 Step -1
                rowToDelete = rows(i)
                Dim currentC As String, currentD As String, currentF As String, currentG As String
                currentC = ws.Cells(rowToDelete, 3).Value
                currentD = ws.Cells(rowToDelete, 4).Value
                currentF = ws.Cells(rowToDelete, 6).Value
                currentG = ws.Cells(rowToDelete, 7).Value

                If currentC <> firstC Or currentF <> firstF Then
                    ' If 市区町村名列（C列）内容不同 || 市区町村名3(F列)内容不同
                    ws.Cells(retainRow, 3).ClearContents
                    ws.Cells(retainRow, 4).ClearContents
                    ws.Cells(retainRow, 6).ClearContents
                    ws.Cells(retainRow, 7).ClearContents
                    ws.Rows(rowToDelete).Delete
                    deleteCount = deleteCount + 1
                ElseIf (currentC = firstC And currentF = firstF) And (currentD <> firstD Or currentG <> firstG) Then
                    ' If 市区町村名列（C列）内容相同 && 市区町村名3(F列)内容相同 && 町域名(D列)内容不同 || 町域名4（G列）内容不同
                    ws.Cells(retainRow, 4).ClearContents
                    ws.Cells(retainRow, 7).ClearContents
                    ws.Rows(rowToDelete).Delete
                    deleteCount = deleteCount + 1
                ElseIf currentC = firstC And currentF = firstF And currentD = firstD And currentG = firstG Then
                    ' If 市区町村名列（C列）内容相同 && 市区町村名3(F列)内容相同 && 町域名(D列)内容相同 && 町域名4（G列）内容相同
                    ws.Rows(rowToDelete).Delete
                    deleteCount = deleteCount + 1
                End If
            Next i
        End If
    Next key

    MsgBox "deleted::: " & deleteCount & " :::deleted"
End Sub

Sub CompareSheets()
    Dim ws1 As Worksheet, ws2 As Worksheet
    Dim newSheet1 As Worksheet, newSheet2 As Worksheet, newSheet3 As Worksheet
    Dim dict1 As Object, dict2 As Object
    Dim i As Long, lastRow1 As Long, lastRow2 As Long
    Dim pc As String
    Dim key As Variant

    ' Set worksheets
    Set ws1 = ThisWorkbook.Sheets("sheet1")
    Set ws2 = ThisWorkbook.Sheets("sheet2")

    ' Create new sheets
    Set newSheet1 = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    newSheet1.Name = "MATCH"
    Set newSheet2 = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    newSheet2.Name = "sheet1only"
    Set newSheet3 = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    newSheet3.Name = "sheet2only"

    ' Create dictionaries to hold POST_CODE values
    Set dict1 = CreateObject("Scripting.Dictionary")
    Set dict2 = CreateObject("Scripting.Dictionary")

    ' Get last rows of each sheet
    lastRow1 = ws1.Cells(ws1.Rows.Count, "A").End(xlUp).Row
    lastRow2 = ws2.Cells(ws2.Rows.Count, "A").End(xlUp).Row

    ' Populate dictionaries
    For i = 2 To lastRow1 ' Assuming headers are in the first row
        pc = ws1.Cells(i, 1).Value
        If Not dict1.exists(pc) Then
            dict1.Add pc, i
        End If
    Next i

    For i = 2 To lastRow2 ' Assuming headers are in the first row
        pc = ws2.Cells(i, 1).Value
        If Not dict2.exists(pc) Then
            dict2.Add pc, i
        End If
    Next i

    ' Compare and populate new sheets
    Dim row1 As Long, row2 As Long, row3 As Long
    row1 = 2 ' Start from the second row, assuming the first row is header
    row2 = 2 ' Start from the second row, assuming the first row is header
    row3 = 2 ' Start from the second row, assuming the first row is header

    For Each key In dict1.keys
        If dict2.exists(key) Then
            ' Matching POST_CODE
            newSheet1.Rows(row1).Value = ws1.Rows(dict1(key)).Value
            row1 = row1 + 1
        Else
            ' POST_CODE in sheet1 but not in sheet2
            newSheet2.Rows(row2).Value = ws1.Rows(dict1(key)).Value
            row2 = row2 + 1
        End If
    Next key

    For Each key In dict2.keys
        If Not dict1.exists(key) Then
            ' POST_CODE in sheet2 but not in sheet1
            newSheet3.Rows(row3).Value = ws2.Rows(dict2(key)).Value
            row3 = row3 + 1
        End If
    Next key

    ' Copy headers to new sheets (assuming headers are in the first row)
    newSheet1.Rows(1).Value = ws1.Rows(1).Value
    newSheet2.Rows(1).Value = ws1.Rows(1).Value
    newSheet3.Rows(1).Value = ws2.Rows(1).Value
End Sub
